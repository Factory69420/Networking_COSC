1. ARP Storm
What MAC address is initiating the ARP Storm?
ssh -x over then use wireshark on the pcap make filter arp and find src mac




00:07:0d:af:f4:54




2. ARP – 1
What is the MAC of 10.10.10.1?

00:1d:09:f0:92:ab



3. ARP – 2
What is the MAC of 10.10.10.2?

00:1a:6b:6c:0c:cc




4. ARP – 3

What is the MAC address of the system trying to perform the ARP MitM attack?
use arp.opcode == 2 for gratious arp or w/e and this will let us see packets that indicate a mitm

check src mac/ip
fa:16:3e:35:21:5a


5. RARP – 1
What is the OP code of a RARP Request?

3


6. RARP – 2
What is the OP code of a RARP Response?

4




7. RARP – 3
What is the RARP requestor’s MAC?
arp.opcode == 3
00:0c:29:34:0b:de

8. RARP – 4
What was the RARP requestor’s resolved IP address?
kill filter go down frame and look at packet data
10.1.1.100

9. Gratuitous ARP – 1
What is the MAC of the system spamming gratuitous ARP’s for 192.168.1.254?

00:00:5e:00:01:01


10. CDP – 1
What is the software version of the Cisco Switch IOS (copy entire field “as is” from Wireshark)?


cdp as filter
right click copy value on CDP software version 
IOS (tm) C2950 Software (C2950-I6K2L2Q4-M), Version 12.1(22)EA14, RELEASE SOFTWARE (fc1)





11. CDP – 2
What is the software version of the Cisco Router IOS (copy entire field “as is” from Wireshark)?
IOS (tm) 1600 Software (C1600-NY-L), Version 11.2(12)P, RELEASE SOFTWARE (fc1)




12. LLDP – 1
What is the System Name of one of the LLDP sending devices?
use LLDP as filter go and find system name
S2.cisco.com

13. STP – 1
What is the Bridge Priority of the STP Root Bridge?
use STP as filter
go to root identefier
root priorty
0

14. STP – 2
What is the MAC address of the STP Root Bridge?

root bridge system id under root identefier
00:1f:27:b4:7d:80


15. VTP – 1
What is the VTP Management Domain Name?
ok vlan trunking protocol
management domain:
cisco


16. VTP – 2
What is the latest configuration revision number?
config revision number: 11
11


17. VTP – 3
How many total VLANs are being advertised via VTP?
manually count the amount of "VLAN information" tabs
22


18. VLAN – 1
What is the message contained within the single tagged VLAN traffic coming from 11.22.33.44?


ip.addr == 11.22.33.44
maybe add and vlan? to filter
check tcp segment data

I pitty the foo

19. VLAN – 2
What is the VLAN ID of this traffic?



999
check ethernet header 


20. VLAN Hopping – 1
What is the VLAN ID being attacked by 10.10.10.10 using Double Tagging?

ip.addr == 10.10.10.10

check virtual lan id

250






21. VLAN Hopping – 2

What is the combined message being sent via ICMP?
same filter look at all 8 icmp packets


Wouldn't you like too be a Pepper Too!



22. ICMP – 1


What is the OS of 192.168.1.1 host based off its Echo Request message to the Google DNS?

ip.addr == 192.168.1.1

Linux
(based off of 64 being ttl)




23. ICMP – 2
What is the message that 192.168.65.20 sending to Google's DNS via ICMP?

Exsqueeze me?



24. ICMP – 3
How many Hops away is the 151.101.64.84 address?
ip.addr == 151.101.64.84
first pack has 10.10.10.10 look at the ttl of that first packet.



11



25. ICMP – 4
What is the OS of 10.10.205.253 host based off its Echo Request message to 10.10.0.40?


icmp.type == 8 and ip.addr == 10.10.205.253

ttl is 123

Windows


26. Fragmented – 1
What is the IP ID of the fragmented ICMP packet in Decimal? (starting at packet 6472)

Scroll to frame 6472 and look at IPV4 identiication hex and decimal value.

46544



27. Fragmented – 2

What is the offset value of the fragments?

    Not the calculated value shown in Wireshark

    Suggest converting the value from the Hex Dump

go to next frame for some reason 
look at fragment offset in hex and chatgpt it to decimal


122




28. ICMPv6 – 1


What is the ICMPv6 type number of Echo Request?


128 (Use chatgpt)



29. ICMPv6 – 2
What is the ICMPv6 type number of Echo Reply?

129 (use chatgpt)



30. ICMPv6 – 3

What is the ICMPv6 type number of the Router Advertisement message?

134(use chatgpt)




31. ICMPv6 – 4
What is the link-layer address of the advertising router?

icmpv6.type == 134

router advertisement from:
fa:16:3e:35:21:5a


32. ICMPv6 – 5
What is the IPv6 prefix being advertised?

look at icmpv6 option prefix information
beef:4:f00d::



33. HSRP – 1
What is the HSRP virtual IP?

use hsrp filter
go to cisco hot standby router protocol
find virtual ip address field
192.168.0.1


34. HSRP – 2
What is the HSRP multicast address used?

224.0.0.2 (the desination address on the hsrp packets)


35. HSRP – 3
What is the IP address of the HSRP Active forwarder (before the takeover)?

first source IP to send HSRP packets

192.168.0.30


36. HSRP – 4

What is the IP address of the HSRP Active forwarder (after the takeover)?


last source IP to send hsrp packets
192.168.0.10



37. VRRP – 1
What is the VRRP multicast address used?

vrrp
look at destination ip

224.0.0.18

38. VRRP – 2
What is the VRRP virtual IP?

same filter look at vrrp in packet data and it will say IP ADDRESS:

192.168.1.254









39. VRRP – 3
How many total devices are communicating via VRRP?


look at how many different ips send packets via VRRP
3


40. RIP – 1

How many networks are being advertised via RIP?

use rip as filter
I just guessed

2



41. RIP – 2

What are the networks being advertised (in numeric order separated by commas and no spaces)?

(i.e. 1.0.0.0,2.0.0.0 )
click on packets under rip it will say ip address



200.0.1.0,200.0.2.0






42. RIP – 3

What Protocol and port is being used for RIP?

PROTOCOL PORT

UDP 520


43. EIGRPv4 – 1

What network is being advertised via EIGRPv4

do eigrp filter and look at update packet

192.168.4.0/24






44. EIGRPv4 – 2


google
88



45. EIGRPv4 – 3
What multicast address is used to send EIGRPv4 updates?

224.0.0.10

46. EIGRPv6 – 1
What network is being advertised via EIGRPv6



2001:db8:0:400::/64


47. EIGRPv6 – 2

What multicast address is used to send EIGRPv6 updates?

ff02::a





48. EIGRPv6 – 3

What Autonomous system number is being used?


100


look at hello ack frame



49. OSPF – 1

What is the IP protocol number used for OSPF?


google

89







50. OSPF – 2

What is the IP address of the OSPF designated router (DR)?

type in ospf look at hello packet and it will say

192.168.170.8



51. OSPF – 3

What multicast address is used by the DR to send updates?

224.0.0.5



52. BGP – 1

How many networks are being advertised via BGP?


3


just used BGP as a filter and looked at ip in the packets that showed up




53. BGP – 2
What are the networks being advertised (in numeric order separated by commas and no spaces)?

(i.e. 1.0.0.0,2.0.0.0)

BGP check packets for cidrs


10.0.0.0/8,172.16.0.0/16,192.168.4.0/22




54. BGP – 3
What Autonomous system number is the 192.168.0.10 peer in?
use bgp filter 


use bgp filter open keepalive/update combo  packet
under path attribute agggregator AS: 65210
65210



-----------------------------------------------------------------------------------DAY 2--------------------------------------------------------------
sudo tcpdump  -r /home/activity_resources/pcaps/BPFCheck.pcap "FILTER HERE!!!!!!" | wc -l


Basic Analysis - ttl
What is the Berkeley Packet Filter, using tcpdump, to capture all packets with a ttl of 64 and less, utilizing the IPv4 or IPv6 Headers? There should be 8508 packets.

Enter the Filter syntax with no spaces

ip[8]<=64||ip6[7]<=64



Basic Analysis - dont fragment


What is the Berkeley Packet Filter, using tcpdump, to capture all IPv4 packets with at least the Dont Fragment bit set? There should be 2321 packets.

Enter the Filter syntax with no spaces

ip[6]&0x40=0x40





Basic Analysis - high port
What is the Berkeley Packet Filter, using tcpdump, to capture traffic with a Source Port higher than 1024, utilizing the correct Transport Layer Headers? There should be 7805 packets.

Enter the Filter syntax with no spaces

tcp[0:2]>1024||udp[0:2]>1024




Basic Analysis - udp

What is the Berkeley Packet Filter, using tcpdump, to capture all Packets with UDP protocol being set, utilizing the IPv4 or IPv6 Headers? There should be 1277 packets.

Enter the Filter syntax with no spaces


ip[9]=0x11||ip6[6]=0x11


Basic Analysis - tcp flags

What is the Berkeley Packet Filter, using tcpdump, to capture only packets with the ACK/RST or ACK/FIN flag set, utilizing the correct Transport Layer Header? There should be 1201 packets.

Enter the Filter syntax with no spaces



tcp[13]=20||tcp[13]=17


Basic Analysis - id

What is the Berkeley Packet Filter, using tcpdump, to capture all packets with an IP ID field of 213? There should be 10 packets.

Enter the Filter syntax with no spaces


ip[4:2]=213







Basic Analysis - vlan

What is the Berkeley Packet Filter, using tcpdump, to capture all traffic that contains a VLAN tag? There should be 182 packets.

Enter the Filter syntax with no spaces



ether[12:2]=0x8100




Basic Analysis - dns

What is the Berkeley Packet Filter, using tcpdump, to capture all packets relating to DNS? There should be 63 packets.

Enter the Filter syntax with no spaces




tcp[0:2]=53||tcp[2:2]=53||udp[0:2]=53||udp[2:2]=53



Basic Analysis - CLIENT CONNECTIONS


What is the Berkeley Packet Filter, using tcpdump, to capture the initial packets from a client trying to initiate a TCP connection? There should be 3447 packets

Enter the Filter syntax with no spaces


HINT:
What TCP flags are set by the client when initiating a TCP connection to a server?

tcp[13]=2




Basic Analysis - OPEN PORTS

What is the Berkeley Packet Filter, using tcpdump, to capture the response packets from a server listening on an open TCP ports? There should be 277 packets

Enter the Filter syntax with no spaces



Continuing from CLIENT CONNECTIONS. What flags do the server use to respond to the connection request if the port is open?



tcp[13]=18

Basic Analysis - CLOSED PORTS

What is the Berkeley Packet Filter, using tcpdump, to capture the response packets from a server with closed TCP ports There should be 17 packets

Enter the Filter syntax with no spaces




Continuing from CLIENT CONNECTIONS. What flags do the server use to respond to the connection request if the port is closed?



tcp[13]=4



Basic Analysis - WELL KNOWN PORTS

What is the Berkeley Packet Filter, using tcpdump, to capture all TCP and UDP packets sent to the well known ports? There should be 3678 packets

Enter the Filter syntax with no spaces






tcp[2:2]<1024||udp[2:2]<1024




Basic Analysis - HTTP

What is the Berkeley Packet Filter, using tcpdump, to capture all HTTP traffic? There should be 1404 packets

Enter the Filter syntax with no spaces


tcp[0:2]=80||tcp[2:2]=80




Basic Analysis - TELNET
What is the Berkeley Packet Filter, using tcpdump, to capture all telnet traffic? There should be 62 packets

Enter the Filter syntax with no spaces



tcp[0:2]=23||tcp[2:2]=23




Basic Analysis - ARP
What is the Berkeley Packet Filter, using tcpdump, to capture all ARP traffic? There should be 40 packets

Enter the Filter syntax with no spaces


ether[12:2]=0x0806



Basic Analysis - EVIL BIT
What is the Berkeley Packet Filter, using tcpdump, to capture if the "Evil bit" is set? There should be 197 packets

Enter the Filter syntax with no spaces


Research Evil bit in networking to determine what it means so you can create a filter for it.

RESERVED BIT

ip[6]&128=128
or
ip[6]&0xE0=0xE0





Basic Analysis - TOTAL CHAOS

What is the Berkeley Packet Filter, using tcpdump, to capture any packets containing the CHAOS protocol within an IPv4 header? There should be 139 packets

Enter the Filter syntax with no spaces

HINT:
Research how to identify the CHAOS protocol to determine how to filter for it.


CHAOS PROTOCOL IS PORT 16

ip[9]=16



Basic Analysis - dscp

What is the Berkeley Packet Filter, using tcpdump, to capture all IPv4 packets with the DSCP field of 37? There should be 42 packets.

Enter the Filter syntax with no spaces

ip[1]>>2=37




Basic Analysis - traceroute
What is the Berkeley Packet Filter, using tcpdump, to capture all IPv4 packets targeting just the beginning of potential traceroutes as it's entering your network. This can be from a Windows or Linux machine using their default settings? There should be 83 packets.

Enter the Filter syntax with no spaces

Hint 1:
Research how traceroute operates.

How can you identify an initial traceroute that enters your network?


Hint 2:
What is the default carrier protocols used by Windows?

By Linux?


https://www.hackingarticles.in/working-of-traceroute-using-wireshark/



ip[8]=1&&(ip[9]=0x11||ip[9]=0x01)







Basic Analysis - URGent EXFIL

What is the Berkeley Packet Filter, using tcpdump, to capture all packets where the URG flag is not set and URG pointer has a value? There should be 43 packets

Enter the Filter syntax with no spaces


tcp[13]&32=0&&tcp[18:2]!=0



Basic Analysis - NULL SCAN
What is the Berkeley Packet Filter, using tcpdump, to capture a TCP null scan to the host 10.10.10.10? There should be 19 packets

Enter the Filter syntax with no spaces
HINT:
Research NMAP Null scan to determine how to filter for it.



ip[16:4]=0x0a0a0a0a&&tcp[13]=0





Basic Analysis - VLAN HOPPING
What is the Berkeley Packet Filter, using tcpdump, to capture an attacker using vlan hopping to move from vlan 1 to vlan 10? There should be 15 packets

Enter the Filter syntax with no spaces


0xx8100000 is vlan1
0x8100000a is vlan 10

0xffff0fff is the pcp/dei in vlan tag under ethernet 2

ether[12:4]&0xffff0fff=0x81000001&&ether[16:4]&0xffff0fff=0x8100000a




-------------------------------------------DAY 3---------------------------------------------------------------------
AddressFamilies

What are the 3 Address Families associated with the python3 socket module?

example:

socket.ADDFAM, socket.ADDFAM, socket.ADDFAM


socket.AF_INET, socket.AF_INET6, socket.AF_UNIX




Connections

What are the two socket functions called for a Client to open a connection and to disconnect from that connection?

example:

socket.fun(), socket.func()


socket.connect(), socket.close()


Header Preparation

What python3 library function is utilized to combine the various pieces of your raw socket packet into network order?

example:

module.function

Sgt Hutch helped me :)
Check FG for struct module stuf
struct.pack


Missing Data

What must be manually created with raw sockets that stream and datagram sockets creates for you?

header



Sending UDP

What function within the socket module allows you to Send data to a socket, while not already being connected to a remote socket?

example:

socket.func()


socket.sendto()


Transport Layer Sockets

Provide an example of the two required items needed to be set in order to send a Datagram or Stream socket? (excluding any of the socket.socket functions)

example:

item1 item2

These are the 2 parts to a socket


ip port




Objects



When sending data across a connection, what must a string be converted to before being sent due to encoding?

bytes





Stream Socket Message Sender



Gorgan Forces have requested you get a message to one of their remote teams that are utilizing the BLUE_DMZ_HOST-1. Utilizing the criteria they provided, generate a stream socket with python3:

Coded information was placed into the video below. Look at the note the woman passes to the man.

https://youtu.be/6WTdTwcmxyo?t=35

    From your INTERNET-HOST to the BLUE_DMZ_HOST-1
    Port number = #Last four digits on the note

    Message = #Name on the note (First letter capitalized)





